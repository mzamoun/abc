<!DOCTYPE html>
<html>
<head> <meta charset="utf-8" />
    <title>Groupe ABC : Projets Diaspora en Algerie</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>    

    <script src="gen.js" > </script>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="login.css">
    <link rel="stylesheet" href="msg.css">


</head>
 
<body>
    <div id="success" class="success box"  >  </div>
    <div id="error" class="error box"  >  </div>
         
    
    <form>
        
        <div class="login">
            <h3 class="center"> Connexion: </h3>
            <input type="text" placeholder="Email" id="username">  
            <input type="password" placeholder="Password" id="password">  

                <a href="#" class="forgot">forgot password?</a>

          <input type="submit" id="submit" value="Sign In">

        </div>
        <div class="shadow"></div>

    </form>
 
</body>
</html>
 
<script>
    var url = 'https://script.google.com/macros/s/AKfycbx4xHoWuM9R5ogwWOvM2Vej2Z8L8Ox1_-4zA6esI6T5chONcsWbtDiUqxJJtqUeuNSq/exec';

    function hideInfos() {
        showDiv('success', false);
        showDiv('error', false);
    }

    function showSuccess() {
        showDiv('success', true);
    }
    function showError() {
        showDiv('error', true);
    }
    function setSuccess(msg) {
        loadDiv('success', msg);
    }
    function setError(msg) {
        loadDiv('error', msg);
    }

    function onLogin  (e) {
        console.log(e);
        var msg = JSON.stringify(e.data);
        msg = msg.substring(1, msg.length-1);   //supprimer les guillemets debut/fin
        if(msg.startsWith('ERROR')) {
            setError("<p>Info Login:</p>"  + msg );
            showError();
        }else {
            setSuccess("<p>Info Login:</p>"  + msg );
            showSuccess();
        }

    }     

    function callMeGet  (e) {
        console.log(e);
        $("#resultat").html("<p>Get:</p>"  + JSON.stringify(e.data) );
    }  

    function callMePost  (e) {
        console.log(e);
        $("#resultat").html("<p>Post:</p>"  + JSON.stringify(e.data) );
    }    
    
 
$(document).ready(function(){

    hideInfos();

    $("#submit").click(function(e){
        e.preventDefault();
        hideInfos();

        var myData = {
            cmd: 'login',
            email : $("#username").val(),  // Nous récupérons la valeur de nos input que l'on fait passer à connexion.php
            password : $("#password").val(),
            callbackFun : 'onLogin'
        };

        $.ajax({
            type: 'POST',
            crossDomain: true,
            url: url ,
            data: myData,
            dataType: "jsonp",
            success: function(e) {
                console.log('success', e);
            },
            error: function(e) {
                console.log('error', e);
            },
        });

   });

});
 
</script>

<!--

https://mzamoun.github.io/abc/index.html

-->